matrix:
  include:
  - name: "xenial/flask/python3.7"
    language: python
    python: 3.7
    dist: xenial
    sudo: true
    env:
      - FLASK_ENV=development
      - API_VERSION=1
      - CONFIG_FILE=$TRAVIS_BUILD_DIR/instance/testing.json
      - TESTING=1
      - DEBUG=1
    before_script:
      - python3 $TRAVIS_BUILD_DIR/src/migrate.py db init
      - python3 $TRAVIS_BUILD_DIR/src/migrate.py db migrate
      - python3 $TRAVIS_BUILD_DIR/src/migrate.py db upgrade
      - cp $TRAVIS_BUILD_DIR/instance/testing.json $TRAVIS_BUILD_DIR/src/
    script:
      - python3 $TRAVIS_BUILD_DIR/src/test.py
